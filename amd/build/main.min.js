define ("local_chatfiles/main",["jquery"],function(a){return{init:function init(b){b=a(b);b.bind("click",this.uploadFile(b))},uploadFile:function uploadFile(){var b,c=0;if(a("[id^=drawer] #chatfile").prop("files")[0]){b=a("[id^=drawer] #chatfile").prop("files")[0];c=1}else{b=a("#page #chatfile").prop("files")[0];c=2}if(!b){return}var d=new FormData;d.append("file",b);var e=a("[data-region=\"view-conversation\"] [data-region=\"header-content\"] strong.text-truncate").text();d.append("name",e);d.append("drawer",c);a.ajax({url:M.cfg.wwwroot+"/local/chatfiles/ajax.php?sesskey="+M.cfg.sesskey,dataType:"text",cache:!1,contentType:!1,processData:!1,data:d,type:"post",success:function success(b){var c,d=a.parseJSON(b);if(1==d.drawer){c=a("[id^=drawer] [data-region=\"send-message-txt\"]")}else if(2==d.drawer){c=a("#page [data-region=\"send-message-txt\"]")}if(d.error){a("#chatfile").val("");return}var e="<p class=\"text-success font-italic\"><a class=\"\" href=\""+d.url+"\"><i class=\"fa fa-file-o fa-2x pr-2 d-block\"></i>"+d.filename+"</a></p>";c.val(e);if(1==d.drawer){a("[id^=drawer] #chatfile").val("");a("[data-action=\"send-message\"]").click()}else if(2==d.drawer){a("#page #chatfile").val("");a("#page [data-action=\"send-message\"]").click()}}})}}});
//# sourceMappingURL=main.min.js.map
