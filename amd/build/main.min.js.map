{"version":3,"sources":["../src/main.js"],"names":["define","$","init","upload","bind","uploadFile","fileData","drawer","prop","formData","FormData","append","username","text","ajax","url","M","cfg","wwwroot","sesskey","dataType","cache","contentType","processData","data","type","success","response","textarea","obj","parseJSON","error","val","file","filename","click"],"mappings":"AAAAA,OAAM,wBACF,CAAC,QAAD,CADE,CAEF,SAASC,CAAT,CAAY,CAEZ,MAAO,CACHC,IAAI,CAAE,cAASC,CAAT,CAAiB,CACnBA,CAAM,CAAGF,CAAC,CAACE,CAAD,CAAV,CACAA,CAAM,CAACC,IAAP,CAAY,OAAZ,CAAqB,KAAKC,UAAL,CAAgBF,CAAhB,CAArB,CACH,CAJE,CAMHE,UAAU,CAAE,qBAAW,IACfC,CAAAA,CADe,CAEfC,CAAM,CAAG,CAFM,CAGnB,GAAIN,CAAC,CAAC,wBAAD,CAAD,CAA4BO,IAA5B,CAAiC,OAAjC,EAA0C,CAA1C,CAAJ,CAAkD,CAC9CF,CAAQ,CAAGL,CAAC,CAAC,wBAAD,CAAD,CAA4BO,IAA5B,CAAiC,OAAjC,EAA0C,CAA1C,CAAX,CACAD,CAAM,CAAG,CACZ,CAHD,IAGO,CACHD,CAAQ,CAAGL,CAAC,CAAC,iBAAD,CAAD,CAAqBO,IAArB,CAA0B,OAA1B,EAAmC,CAAnC,CAAX,CACAD,CAAM,CAAG,CACZ,CACD,GAAI,CAACD,CAAL,CAAe,CACZ,MACF,CACD,GAAIG,CAAAA,CAAQ,CAAG,GAAIC,CAAAA,QAAnB,CACAD,CAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBL,CAAxB,EACA,GAAIM,CAAAA,CAAQ,CAAGX,CAAC,CAAC,2FAAD,CAAD,CAA2FY,IAA3F,EAAf,CACAJ,CAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBC,CAAxB,EACAH,CAAQ,CAACE,MAAT,CAAgB,QAAhB,CAA0BJ,CAA1B,EACAN,CAAC,CAACa,IAAF,CAAO,CACHC,GAAG,CAAEC,CAAC,CAACC,GAAF,CAAMC,OAAN,CAAgB,oCAAhB,CAAuDF,CAAC,CAACC,GAAF,CAAME,OAD/D,CAEHC,QAAQ,CAAE,MAFP,CAGHC,KAAK,GAHF,CAIHC,WAAW,GAJR,CAKHC,WAAW,GALR,CAMHC,IAAI,CAAEf,CANH,CAOHgB,IAAI,CAAE,MAPH,CAQHC,OAAO,CAAE,iBAASC,CAAT,CAAmB,IACpBC,CAAAA,CADoB,CAEpBC,CAAG,CAAG5B,CAAC,CAAC6B,SAAF,CAAYH,CAAZ,CAFc,CAGxB,GAAkB,CAAd,EAAAE,CAAG,CAACtB,MAAR,CAAqB,CACjBqB,CAAQ,CAAG3B,CAAC,CAAC,iDAAD,CACf,CAFD,IAEO,IAAkB,CAAd,EAAA4B,CAAG,CAACtB,MAAR,CAAqB,CACxBqB,CAAQ,CAAG3B,CAAC,CAAC,0CAAD,CACf,CAED,GAAI4B,CAAG,CAACE,KAAR,CAAe,CACX9B,CAAC,CAAC,WAAD,CAAD,CAAe+B,GAAf,CAAmB,EAAnB,EACA,MACH,CACD,GAAIC,CAAAA,CAAI,CAAG,8DAA2DJ,CAAG,CAACd,GAA/D,CACV,sDADU,CAC4Cc,CAAG,CAACK,QADhD,CAC2D,UADtE,CAEAN,CAAQ,CAACI,GAAT,CAAaC,CAAb,EACA,GAAkB,CAAd,EAAAJ,CAAG,CAACtB,MAAR,CAAqB,CACjBN,CAAC,CAAC,wBAAD,CAAD,CAA4B+B,GAA5B,CAAgC,EAAhC,EACA/B,CAAC,CAAC,gCAAD,CAAD,CAAkCkC,KAAlC,EACH,CAHD,IAGO,IAAkB,CAAd,EAAAN,CAAG,CAACtB,MAAR,CAAqB,CACxBN,CAAC,CAAC,iBAAD,CAAD,CAAqB+B,GAArB,CAAyB,EAAzB,EACA/B,CAAC,CAAC,sCAAD,CAAD,CAAwCkC,KAAxC,EACH,CACJ,CA/BE,CAAP,CAiCD,CAzDA,CA2DV,CA/DK,CAAN","sourcesContent":["define(\n    ['jquery'],\n    function($) {\n\n    return {\n        init: function(upload) {\n            upload = $(upload);\n            upload.bind('click', this.uploadFile(upload));\n        },\n\n        uploadFile: function() {\n            let fileData;\n            let drawer = 0;\n            if ($('[id^=drawer] #chatfile').prop('files')[0]) {\n                fileData = $('[id^=drawer] #chatfile').prop('files')[0];\n                drawer = 1;\n            } else {\n                fileData = $('#page #chatfile').prop('files')[0];\n                drawer = 2;\n            }\n            if (!fileData) {\n               return;\n            }\n            var formData = new FormData();\n            formData.append('file', fileData);\n            var username = $('[data-region=\"view-conversation\"] [data-region=\"header-content\"] strong.text-truncate').text();\n            formData.append('name', username);\n            formData.append('drawer', drawer);\n            $.ajax({\n                url: M.cfg.wwwroot + '/local/chatfiles/ajax.php?sesskey=' + M.cfg.sesskey,\n                dataType: 'text',\n                cache: false,\n                contentType: false,\n                processData: false,\n                data: formData,\n                type: 'post',\n                success: function(response) {\n                    var textarea;\n                    var obj = $.parseJSON(response);\n                    if (obj.drawer == 1) {\n                        textarea = $('[id^=drawer] [data-region=\"send-message-txt\"]');\n                    } else if (obj.drawer == 2) {\n                        textarea = $('#page [data-region=\"send-message-txt\"]');\n                    }\n\n                    if (obj.error) {\n                        $('#chatfile').val(\"\");\n                        return;\n                    }\n                    var file = '<p class=\"text-success font-italic\"><a class=\"\" href=\"' + obj.url +\n                     '\"><i class=\"fa fa-file-o fa-2x pr-2 d-block\"></i>' + obj.filename + '</a></p>';\n                    textarea.val(file);\n                    if (obj.drawer == 1) {\n                        $('[id^=drawer] #chatfile').val(\"\");\n                        $('[data-action=\"send-message\"]').click();\n                    } else if (obj.drawer == 2) {\n                        $('#page #chatfile').val(\"\");\n                        $('#page [data-action=\"send-message\"]').click();\n                    }\n                }\n             });\n          },\n    };\n});\n"],"file":"main.min.js"}