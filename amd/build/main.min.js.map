{"version":3,"sources":["../src/main.js"],"names":["define","$","init","upload","bind","uploadFile","file_data","prop","form_data","FormData","append","username","text","ajax","url","M","cfg","wwwroot","sesskey","dataType","cache","contentType","processData","data","type","success","response","textarea","obj","parseJSON","console","log","error","alert","val","file","filename","click"],"mappings":"AAAAA,OAAM,wBACF,CAAC,QAAD,CADE,CAEF,SAASC,CAAT,CAAY,CAEZ,MAAO,CACHC,IAAI,CAAE,cAASC,CAAT,CAAiB,CACnBA,CAAM,CAAGF,CAAC,CAACE,CAAD,CAAV,CACAA,CAAM,CAACC,IAAP,CAAY,OAAZ,CAAqB,KAAKC,UAAL,CAAgBF,CAAhB,CAArB,CACH,CAJE,CAMHE,UAAU,CAAE,qBAAY,CACpB,GAAIC,CAAAA,CAAS,CAAGL,CAAC,CAAC,WAAD,CAAD,CAAeM,IAAf,CAAoB,OAApB,EAA6B,CAA7B,CAAhB,CACA,GAAI,CAACD,CAAL,CAAgB,CAAE,MAAS,CAC3B,GAAIE,CAAAA,CAAS,CAAG,GAAIC,CAAAA,QAApB,CACAD,CAAS,CAACE,MAAV,CAAiB,MAAjB,CAAyBJ,CAAzB,EACA,GAAIK,CAAAA,CAAQ,CAAGV,CAAC,CAAC,2FAAD,CAAD,CAA2FW,IAA3F,EAAf,CACAJ,CAAS,CAACE,MAAV,CAAiB,MAAjB,CAAyBC,CAAzB,EACAV,CAAC,CAACY,IAAF,CAAO,CACHC,GAAG,CAAEC,CAAC,CAACC,GAAF,CAAMC,OAAN,CAAgB,oCAAhB,CAAuDF,CAAC,CAACC,GAAF,CAAME,OAD/D,CAEHC,QAAQ,CAAE,MAFP,CAGHC,KAAK,GAHF,CAIHC,WAAW,GAJR,CAKHC,WAAW,GALR,CAMHC,IAAI,CAAEf,CANH,CAOHgB,IAAI,CAAE,MAPH,CAQHC,OAAO,CAAE,iBAASC,CAAT,CAAkB,IACnBC,CAAAA,CAAQ,CAAG1B,CAAC,CAAC,4CAAD,CADO,CAEnB2B,CAAG,CAAG3B,CAAC,CAAC4B,SAAF,CAAaH,CAAb,CAFa,CAGvBI,OAAO,CAACC,GAAR,CAAcH,CAAd,EACA,GAAIA,CAAG,CAACI,KAAR,CAAe,CACXC,KAAK,CAACL,CAAG,CAACI,KAAL,CAAL,CACA/B,CAAC,CAAC,WAAD,CAAD,CAAeiC,GAAf,CAAmB,EAAnB,EACA,MACH,CACD,GAAIC,CAAAA,CAAI,CAAG,8DAA2DP,CAAG,CAACd,GAA/D,CACV,sDADU,CAC4Cc,CAAG,CAACQ,QADhD,CAC2D,UADtE,CAEAT,CAAQ,CAACO,GAAT,CAAaC,CAAb,EACAlC,CAAC,CAAC,WAAD,CAAD,CAAeiC,GAAf,CAAmB,EAAnB,EACAjC,CAAC,CAAC,gCAAD,CAAD,CAAkCoC,KAAlC,EACH,CAtBE,CAAP,CAwBD,CArCA,CAuCV,CA3CK,CAAN","sourcesContent":["define(\r\n    ['jquery'],\r\n    function($) {\r\n\r\n    return {\r\n        init: function(upload) {\r\n            upload = $(upload);\r\n            upload.bind('click', this.uploadFile(upload));\r\n        },\r\n\r\n        uploadFile: function () {\r\n            var file_data = $('#chatfile').prop('files')[0];\r\n            if (!file_data) { return; }\r\n            var form_data = new FormData();\r\n            form_data.append('file', file_data);\r\n            var username = $('[data-region=\"view-conversation\"] [data-region=\"header-content\"] strong.text-truncate').text()\r\n            form_data.append('name', username);\r\n            $.ajax({\r\n                url: M.cfg.wwwroot + '/local/chatfiles/ajax.php?sesskey=' + M.cfg.sesskey,\r\n                dataType: 'text',\r\n                cache: false,\r\n                contentType: false,\r\n                processData: false,\r\n                data: form_data,\r\n                type: 'post',\r\n                success: function(response){\r\n                    var textarea = $('.drawer [data-region=\"send-message-txt\"]');\r\n                    var obj = $.parseJSON( response );\r\n                    console.log ( obj);\r\n                    if (obj.error) {\r\n                        alert(obj.error);\r\n                        $('#chatfile').val(\"\");\r\n                        return;\r\n                    }\r\n                    var file = '<p class=\"text-success font-italic\"><a class=\"\" href=\"' + obj.url +\r\n                     '\"><i class=\"fa fa-file-o fa-2x pr-2 d-block\"></i>' + obj.filename + '</a></p>';\r\n                    textarea.val(file);\r\n                    $('#chatfile').val(\"\");\r\n                    $('[data-action=\"send-message\"]').click();\r\n                }\r\n             });\r\n          },\r\n    };\r\n});\r\n"],"file":"main.min.js"}